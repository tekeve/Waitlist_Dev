{% load humanize %}
<!--
This file contains *only* the HTML for the columns.
It is injected into waitlist_view.html and also fetched
by the polling JavaScript.
-->
<!-- --- X-UP COLUMN --- -->
<div class="waitlist-column">
    <div class="column-header status-PENDING">
        <h2>X-UP</h2>
        <span class="column-count">{{ xup_fits.count }}</span>
    </div>
    <ul class="fit-card-list">
        {% for fit in xup_fits %}
        <li class="fit-card status-{{ fit.status }}" id="fit-card-{{ fit.id }}" data-submitted-time="{{ fit.submitted_at.isoformat }}">

            <div class="card-header">
                <img src="https://images.evetech.net/characters/{{ fit.character.character_id }}/portrait?size=64"
                     alt="{{ fit.character.character_name }} portrait"
                     class="pilot-portrait">
                <span class="pilot-name">{{ fit.character.character_name }}</span>
                <!-- NEW: Timer container -->
                <span class="wait-timer"></span>
            </div>

            <div class="card-body">
                <!-- --- NEW LAYOUT: Text on left, Image on right --- -->
                <div class="card-body-row">
                    <div class="card-fit-details">
                        <div class="fit-info">
                            <strong>HULL:</strong>
                            <span class="placeholder">{{ fit.ship_name|default:"-" }}</span>
                        </div>
                        <div class="fit-info">
                            <strong>TANK:</strong>
                            <span class="placeholder">{{ fit.tank_type|default:"-" }}</span>
                        </div>

                        <div class="fit-issues">
                            <strong>ISSUES:</strong>
                            <span class="placeholder">{{ fit.fit_issues|default:"-" }}</span>
                        </div>

                        <div class="pilot-stats">
                            <div class="stat-item">
                                <strong>TOTAL HRS:</strong>
                                <span class="placeholder">{{ fit.total_fleet_hours|default:0 }}</span>
                            </div>
                            <div class="stat-item">
                                <strong>HULL HRS:</strong>
                                <span class="placeholder">{{ fit.hull_fleet_hours|default:0 }}</span>
                            </div>
                        </div>
                    </div>

                    <!--
                    --- MODIFIED: Ship Image Container ---
                    Added data-fit-id and js-open-fit-modal
                    -->
                    <div class="ship-image-container js-open-fit-modal"
                         data-fit-id="{{ fit.id }}"
                         title="Click to view fit">
                        {% if fit.ship_type_id %}
                        <img src="https://images.evetech.net/types/{{ fit.ship_type_id }}/render?size=64"
                             alt="{{ fit.ship_name }} hull">
                        {% endif %}
                    </div>
                </div>
                <!-- --- END NEW LAYOUT --- -->
                <!-- --- FC ACTION BUTTONS (MODIFIED) --- -->
                {% if is_fc %}
                <div class="fc-actions">
                    <button class="fc-btn btn-approve"
                            data-fit-id="{{ fit.id }}"
                            data-action="approve"
                            title="Approve Fit">
                        &#x2705; <!-- Checkmark emoji -->
                    </button>
                    <button class="fc-btn btn-deny"
                            data-fit-id="{{ fit.id }}"
                            data-action="deny"
                            title="Deny Fit">
                        &#x274C; <!-- Cross mark emoji -->
                    </button>
                </div>
                {% endif %}
                <!-- --- END MODIFIED --- -->
            </div>
        </li>
        {% endfor %}
    </ul>
</div>

<!-- --- LOGI COLUMN --- -->
<div class="waitlist-column">
    <div class="column-header status-APPROVED">
        <h2>LOGI</h2>
        <span class="column-count">{{ logi_fits.count }}</span>
    </div>
    <!-- Placeholder for Logi cards -->
    <ul class="fit-card-list">
        {% for fit in logi_fits %}
        <li class="fit-card status-{{ fit.status }}" id="fit-card-{{ fit.id }}" data-submitted-time="{{ fit.submitted_at.isoformat }}">

            <div class="card-header">
                <img src="https://images.evetech.net/characters/{{ fit.character.character_id }}/portrait?size=64"
                     alt="{{ fit.character.character_name }} portrait"
                     class="pilot-portrait">
                <span class="pilot-name">{{ fit.character.character_name }}</span>
                <!-- NEW: Timer container -->
                <span class="wait-timer"></span>
            </div>

            <div class="card-body">
                <!-- --- NEW LAYOUT: Text on left, Image on right --- -->
                <div class="card-body-row">
                    <div class="card-fit-details">
                        <div class="fit-info">
                            <strong>HULL:</strong>
                            <span class="placeholder">{{ fit.ship_name|default:"-" }}</span>
                        </div>
                        <div class="fit-info">
                            <strong>TANK:</strong>
                            <span class="placeholder">{{ fit.tank_type|default:"-" }}</span>
                        </div>

                        <div class="fit-issues">
                            <strong>ISSUES:</strong>
                            <span class="placeholder">{{ fit.fit_issues|default:"-" }}</span>
                        </div>

                        <div class="pilot-stats">
                            <div class="stat-item">
                                <strong>TOTAL HRS:</strong>
                                <span class="placeholder">{{ fit.total_fleet_hours|default:0 }}</span>
                            </div>
                            <div class="stat-item">
                                <strong>HULL HRS:</strong>
                                <span class="placeholder">{{ fit.hull_fleet_hours|default:0 }}</span>
                            </div>
                        </div>
                    </div>

                    <!--
                    --- MODIFIED: Ship Image Container ---
                    Added data-fit-id and js-open-fit-modal
                    -->
                    <div class="ship-image-container js-open-fit-modal"
                         data-fit-id="{{ fit.id }}"
                         title="Click to view fit">
                        {% if fit.ship_type_id %}
                        <img src="https://images.evetech.net/types/{{ fit.ship_type_id }}/render?size=64"
                             alt="{{ fit.ship_name }} hull">
                        {% endif %}
                    </div>
                </div>
                <!-- --- END NEW LAYOUT --- -->
                <!-- --- NEW: FC ACTION FOR APPROVED FITS --- -->
                {% if is_fc %}
                <div class="fc-actions">
                    <button class="fc-btn btn-deny"
                            data-fit-id="{{ fit.id }}"
                            data-action="deny"
                            title="Remove from Waitlist">
                        &#x274C; <!-- Cross mark emoji -->
                    </button>
                </div>
                {% endif %}
                <!-- --- END NEW --- -->
            </div>
        </li>
        {% endfor %}
    </ul>
</div>

<!-- --- DPS COLUMN --- -->
<div class="waitlist-column">
    <div class="column-header status-APPROVED">
        <h2>DPS</h2>
        <span class="column-count">{{ dps_fits.count }}</span>
    </div>
    <ul class="fit-card-list">
        {% for fit in dps_fits %}
        <li class="fit-card status-{{ fit.status }}" id="fit-card-{{ fit.id }}" data-submitted-time="{{ fit.submitted_at.isoformat }}">
            <div class="card-header">
                <img src="https://images.evetech.net/characters/{{ fit.character.character_id }}/portrait?size=64"
                     alt="{{ fit.character.character_name }} portrait"
                     class="pilot-portrait">
                <span class="pilot-name">{{ fit.character.character_name }}</span>
                <!-- NEW: Timer container -->
                <span class="wait-timer"></span>
            </div>

            <div class="card-body">
                <!-- --- NEW LAYOUT: Text on left, Image on right --- -->
                <div class="card-body-row">
                    <div class="card-fit-details">
                        <div class="fit-info">
                            <strong>HULL:</strong>
                            <span class="placeholder">{{ fit.ship_name|default:"-" }}</span>
                        </div>
                        <div class="fit-info">
                            <strong>TANK:</strong>
                            <span class="placeholder">{{ fit.tank_type|default:"-" }}</span>
                        </div>

                        <div class="fit-issues">
                            <strong>ISSUES:</strong>
                            <span class="placeholder">{{ fit.fit_issues|default:"-" }}</span>
                        </div>

                        <div class="pilot-stats">
                            <div class="stat-item">
                                <strong>TOTAL HRS:</strong>
                                <span class="placeholder">{{ fit.total_fleet_hours|default:0 }}</span>
                            </div>
                            <div class="stat-item">
                                <strong>HULL HRS:</strong>
                                <span class="placeholder">{{ fit.hull_fleet_hours|default:0 }}</span>
                            </div>
                        </div>
                    </div>

                    <!--
                    --- MODIFIED: Ship Image Container ---
                    Added data-fit-id and js-open-fit-modal
                    -->
                    <div class="ship-image-container js-open-fit-modal"
                         data-fit-id="{{ fit.id }}"
                         title="Click to view fit">
                        {% if fit.ship_type_id %}
                        <img src="https://images.evetech.net/types/{{ fit.ship_type_id }}/render?size=64"
                             alt="{{ fit.ship_name }} hull">
                        {% endif %}
                    </div>
                </div>
                <!-- --- END NEW LAYOUT --- -->
                <!-- --- NEW: FC ACTION FOR APPROVED FITS --- -->
                {% if is_fc %}
                <div class="fc-actions">
                    <button class="fc-btn btn-deny"
                            data-fit-id="{{ fit.id }}"
                            data-action="deny"
                            title="Remove from Waitlist">
                        &#x274C; <!-- Cross mark emoji -->
                    </button>
                </div>
                {% endif %}
                <!-- --- END NEW --- -->
            </div>
        </li>
        {% endfor %}
    </ul>
</div>

<!-- --- SNIPER COLUMN --- -->
<div class="waitlist-column">
    <div class="column-header status-APPROVED">
        <h2>SNIPER</h2>
        <span class="column-count">{{ sniper_fits.count }}</span>
    </div>
    <!-- Placeholder for Sniper cards -->
    <ul class="fit-card-list">
        {% for fit in sniper_fits %}
        <li class="fit-card status-{{ fit.status }}" id="fit-card-{{ fit.id }}" data-submitted-time="{{ fit.submitted_at.isoformat }}">

            <div class="card-header">
                <img src="https://images.evetech.net/characters/{{ fit.character.character_id }}/portrait?size=64"
                     alt="{{ fit.character.character_name }} portrait"
                     class="pilot-portrait">
                <span class="pilot-name">{{ fit.character.character_name }}</span>
                <!-- NEW: Timer container -->
                <span class="wait-timer"></span>
            </div>

            <div class="card-body">
                <!-- --- NEW LAYOUT: Text on left, Image on right --- -->
                <div class="card-body-row">
                    <div class="card-fit-details">
                        <div class="fit-info">
                            <strong>HULL:</strong>
                            <span class="placeholder">{{ fit.ship_name|default:"-" }}</span>
                        </div>
                        <div class="fit-info">
                            <strong>TANK:</strong>
                            <span class="placeholder">{{ fit.tank_type|default:"-" }}</span>
                        </div>

                        <div class="fit-issues">
                            <strong>ISSUES:</strong>
                            <span class="placeholder">{{ fit.fit_issues|default:"-" }}</span>
                        </div>

                        <div class="pilot-stats">
                            <div class="stat-item">
                                <strong>TOTAL HRS:</strong>
                                <span class="placeholder">{{ fit.total_fleet_hours|default:0 }}</span>
                            </div>
                            <div class="stat-item">
                                <strong>HULL HRS:</strong>
                                <span class="placeholder">{{ fit.hull_fleet_hours|default:0 }}</span>
                            </div>
                        </div>
                    </div>

                    <!--
                    --- MODIFIED: Ship Image Container ---
                    Added data-fit-id and js-open-fit-modal
                    -->
                    <div class="ship-image-container js-open-fit-modal"
                         data-fit-id="{{ fit.id }}"
                         title="Click to view fit">
                        {% if fit.ship_type_id %}
                        <img src="https://images.evetech.net/types/{{ fit.ship_type_id }}/render?size=64"
                             alt="{{ fit.ship_name }} hull">
                        {% endif %}
                    </div>
                </div>
                <!-- --- END NEW LAYOUT --- -->
                <!-- --- NEW: FC ACTION FOR APPROVED FITS --- -->
                {% if is_fc %}
                <div class="fc-actions">
                    <button class="fc-btn btn-deny"
                            data-fit-id="{{ fit.id }}"
                            data-action="deny"
                            title="Remove from Waitlist">
                        &#x274C; <!-- Cross mark emoji -->
                    </button>
                </div>
                {% endif %}
                <!-- --- END NEW --- -->
            </div>
        </li>
        {% endfor %}
    </ul>
</div>

<!-- --- REMOVED: MAR_DPS COLUMN --- -->
<!-- --- REMOVED: MAR_SNIPER COLUMN --- -->
<!-- --- NEW: OTHER COLUMN --- -->
<div class="waitlist-column">
    <div class="column-header status-APPROVED">
        <h2>OTHER</h2>
        <span class="column-count">{{ other_fits.count }}</span>
    </div>
    <ul class="fit-card-list">
        {% for fit in other_fits %}
        <li class="fit-card status-{{ fit.status }}" id="fit-card-{{ fit.id }}" data-submitted-time="{{ fit.submitted_at.isoformat }}">
            <div class="card-header">
                <img src="https://images.evetech.net/characters/{{ fit.character.character_id }}/portrait?size=64"
                     alt="{{ fit.character.character_name }} portrait"
                     class="pilot-portrait">
                <span class="pilot-name">{{ fit.character.character_name }}</span>
                <span class="wait-timer"></span>
            </div>
            <div class="card-body">
                <div class="card-body-row">
                    <div class="card-fit-details">
                        <div class="fit-info"><strong>HULL:</strong> <span class="placeholder">{{ fit.ship_name|default:"-" }}</span></div>
                        <div class="fit-info"><strong>TANK:</strong> <span class="placeholder">{{ fit.tank_type|default:"-" }}</span></div>
                        <div class="fit-issues"><strong>ISSUES:</strong> <span class="placeholder">{{ fit.fit_issues|default:"-" }}</span></div>
                        <div class="pilot-stats">
                            <div class="stat-item"><strong>TOTAL HRS:</strong> <span class="placeholder">{{ fit.total_fleet_hours|default:0 }}</span></div>
                            <div class="stat-item"><strong>HULL HRS:</strong> <span class="placeholder">{{ fit.hull_fleet_hours|default:0 }}</span></div>
                        </div>
                    </div>
                    <div class="ship-image-container js-open-fit-modal"
                         data-fit-id="{{ fit.id }}"
                         title="Click to view fit">
                        {% if fit.ship_type_id %}<img src="https://images.evetech.net/types/{{ fit.ship_type_id }}/render?size=64" alt="{{ fit.ship_name }} hull">{% endif %}
                    </div>
                </div>
                {% if is_fc %}
                <div class="fc-actions">
                    <button class="fc-btn btn-deny" data-fit-id="{{ fit.id }}" data-action="deny" title="Remove from Waitlist">&#x274C;</button>
                </div>
                {% endif %}
            </div>
        </li>
        {% endfor %}
    </ul>
</div>